(self.webpackChunkfuse_react_app=self.webpackChunkfuse_react_app||[]).push([[71497],{71497:function(e,t,n){"use strict";n.r(t);var o=n(79545),a=n(68357),o=n(61432),E=n.n(o),a=n(28129),R=n(17725),N=n(25710),Z=n(92466),y=n(96282),o=n(40962),w=n(28344),a=n(78279),_=n.n(a),T=n(78709),k=n(58913),P=n(3089),j=n(55110),L=n(63982),S=n(49073),B=n(66942),a=n(32986),C=n(59415),M=(0,a.ZP)(function(){return n.e(69038).then(n.bind(n,26188))}),A=(0,a.ZP)(function(){return n.e(19125).then(n.bind(n,19125))}),z=(0,a.ZP)(function(){return n.e(5731).then(n.bind(n,5731))}),I=(0,a.ZP)(function(){return Promise.all([n.e(86351),n.e(892)]).then(n.bind(n,892))}),Y=(0,o.Z)(function(e){return{messageRow:{"&.contact":{"& .bubble":{backgroundColor:"#fff",color:"#1E2129",boxShadow:"0 1px 3px #00000029",borderTopLeftRadius:5,borderBottomLeftRadius:5,borderTopRightRadius:5,borderBottomRightRadius:5},"&.first-of-group":{"& .bubble":{borderTopLeftRadius:15}},"&.last-of-group":{"& .bubble":{borderBottomRightRadius:15}}},"&.me":{paddingLeft:20,"& .avatar":{order:2,margin:"0 0 0 16px"},"& .bubble":{marginLeft:"auto",backgroundColor:"#bbc7ef4d",color:"#1E2129",borderTopLeftRadius:5,borderBottomLeftRadius:5,borderTopRightRadius:5,borderBottomRightRadius:5,"& .time":{justifyContent:"flex-end",right:0,marginLeft:6}},"&.first-of-group":{"& .bubble":{borderTopLeftRadius:15}},"&.last-of-group":{"& .bubble":{borderBottomRightRadius:15}}},"&.contact + .me, &.me + .contact":{},"&.first-of-group":{"& .bubble":{borderTopLeftRadius:15,paddingTop:13}},"&.last-of-group":{"& .bubble":{borderBottomRightRadius:15,paddingBottom:13,"& .time":{display:"flex"}}}}}});t.default=function(e){var t,n=(0,k.I0)(),r=((0,k.v9)(function(e){return e.chatAppProject.contacts.selectedContactId}),(0,k.v9)(function(e){return e.chatAppProject.chat})),l=(0,k.v9)(function(e){return e.chatAppProject.contacts.entities}),i=((0,T.useRef)(null),(0,T.useRef)(null),(0,k.v9)(function(e){return e.chatAppProject.user}),Y(e)),o=(0,T.useRef)(null),a=(0,T.useState)(""),c=E()(a,2),a=(c[0],c[1],(0,T.useState)(0)),s=(c=E()(a,2))[0],u=c[1],a=T.useState(0),a=(c=E()(a,2))[0],f=c[1],c=(0,P.Fc)(),d=null==c||null===(t=c.extra)||void 0===t||null===(m=t.profile)||void 0===m?void 0:m.id,m=((0,j.UO)(),(0,T.useState)(null)),m=((m=E()(m,2))[0],m[1],T.useState(!1)),p=(m=E()(m,2))[0],b=m[1],h=(0,k.v9)(function(e){return e.notificationPanel}),m=(0,k.v9)(function(e){return e.chatApp.chat.isUploadingFiles}),g=(0,T.useRef)(null);function v(e,t){return 0===t||r.chats[t-1]&&r.chats[t-1].sender.id!=e.sender.id}function x(e,t){return t===r.chats.length-1||r.chats[t+1]&&r.chats[t+1].sender.id!=e.sender.id}return(0,T.useEffect)(function(){var e;if(null!=r&&(null!==(e=r.chats)&&void 0!==e&&e.length))return setTimeout(function(){b(!0)},600),function(){b(!1)}},[null==r?void 0:r.chats]),(0,T.useEffect)(function(){h.viewing&&p&&g.current&&(n(L.sM()),S.Z.notificationBackrondColor(g,"custom-notification-bg"))},[h.viewing,g,p]),(0,T.useEffect)(function(){var e;null!=r&&(null!==(e=r.chats)&&void 0!==e&&e.length)&&r.chats.length!=s&&(u(r.chats.length),o.current.scrollTop=o.current.scrollHeight)},[null==r?void 0:r.chats]),T.createElement("div",{className:(0,w.Z)("flex flex-col relative chat-box",e.className)},T.createElement(R.Z,{ref:o,className:"flex flex-1 flex-col overflow-y-auto"},m&&T.createElement("div",{className:"linear-progress custom-color"},T.createElement(C.Z,{progress:a})),null!=r&&(null!==(a=r.chats)&&void 0!==a&&a.length)?T.createElement("div",{className:"flex flex-col pt-16 px-16 ltr:pl-48 rtl:pr-48 pb-30 mb-192"},r.chats.map(function(e,t){var n,o,a=e.sender;l.length&&(null==l||l.filter(function(e){return e.id==a.id}));return T.createElement("div",{key:e.date_create,className:(0,w.Z)(i.messageRow,"flex flex-col flex-grow-0 flex-shrink-0 items-start justify-end relative px-20 pb-12",{me:a.id==d},{contact:a.id!=d},{"first-of-group":v(e,t)},{"last-of-group":x(e,t)},t+1===r.length&&"pb-96")},x(e,t)&&a.id!=d&&T.createElement(N.Z,{className:"avatar absolute ltr:left-0 rtl:right-0 m-0 -mx-32 top-0",src:a.photo},a.first_name.split("")[0]),T.createElement("div",{className:"bubble items-center justify-center p-12 max-w-50 relative",ref:(null===(n=h.notificationData)||void 0===n||null===(o=n.notification)||void 0===o?void 0:o.object_id)==e.id?g:null},a.id!=d&&v(e,t)&&T.createElement(Z.Z,{style:{color:null===(t=a.company)||void 0===t?void 0:t.color_project},className:"font-bold mb-6"},"".concat(a.first_name," ").concat(a.last_name),!!a.position&&T.createElement(Z.Z,{className:"font-size-12 "},a.position," - ",null===(t=a.company)||void 0===t?void 0:t.name)),T.createElement(z,{isOffline:e.retryOption,chatItem:e}),!e.waitingToSend&&a.id==d&&T.createElement(M,{className:"text-right chat-options",item:e,deleteMessage:B.$Z,setProgress:f}),T.createElement("div",{className:"leading-normal py-4 font-size-16 mb-15"},e.body),T.createElement(A,{files:e.files}),T.createElement("div",{className:"flex items-center mt-8"},T.createElement(Z.Z,{className:"time text-12 font-500 ltr:left-0 rtl:right-0 whitespace-no-wrap",color:"textSecondary"},_()(e.date_create).format("MMMM Do YYYY, h:mm:ss a")),a.id==d&&e.waitingToSend?T.createElement(y.Z,{className:"float-right ml-10 text-16 text-check"},"access_time"):T.createElement(y.Z,{className:"float-right ml-10 text-16 text-check"},"done_all"))))})):T.createElement("div",{className:"flex flex-col flex-1"},T.createElement("div",{className:"flex flex-col flex-1 items-center justify-center"},T.createElement(y.Z,{className:"text-128",color:"disabled"},"chat")),T.createElement(Z.Z,{className:"px-16 pb-24 text-center",color:"textSecondary"},"Inizia una conversazione inserendo un messaggio"))),T.createElement(I,null))}}}]);