(self.webpackChunkfuse_react_app=self.webpackChunkfuse_react_app||[]).push([[3587],{3587:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var t=n(61432),P=n.n(t),S=n(96569),T=n(86926),O=n(38932),R=n(88325),z=n(48258),L=n(41713),I=n(73772),j=n(96282),A=n(92466),F=n(13786),Y=n(1644),M=n(65087),W=n(78709),X=n(88572),U=n(11208),V=n(3089),$=n(58913),t=n(78279),q=n.n(t),B=n(62475),G=n(21258),H=n(3572),J=n(63982),K=n(53369),t=n(32986),Q=(0,t.ZP)(function(){return Promise.all([n.e(97070),n.e(58630),n.e(78018)]).then(n.bind(n,78018))}),ee=(0,t.ZP)(function(){return Promise.all([n.e(10930),n.e(25872)]).then(n.bind(n,73430))});function a(e){var t,n=e.post,a=e.comment,l=e.getReplies,c=(e.commentId,e.author,e.handleReplyClick),i=e.callRetryReplySuccess,o=e.afterDeleteComment,r=e.tempAuthor,s=e.isOffline,m=e.nameSpace,u=(0,K.$)(void 0===m?"todo_project":m).t,d=(0,$.I0)(),f=(0,W.useState)(!1),p=P()(f,2),e=p[0],E=p[1],m=(0,W.useState)(""),f=P()(m,2),v=f[0],x=f[1],p=(0,W.useState)(!1),m=P()(p,2),f=m[0],g=m[1],p=[{icon:"edit",name:"EDIT",handler:function(){x(a.text),g(!0),C(null)}},{icon:"delete",name:"DELETE",handler:function(e){w(),C(null)}}],m=W.useState(!1),m=P()(m,2),N=m[0],Z=m[1],b=(0,$.v9)(function(e){return e.notificationPanel}),h=(0,W.useRef)(null),y=(null===(m=b.notificationData)||void 0===m||null===(k=m.notification)||void 0===k?void 0:k.object_id)==a.id;(0,W.useEffect)(function(){y?setTimeout(function(){Z(!0)},300):Z(!0)},[a]),(0,W.useEffect)(function(){var e=null===(e=b.notificationData)||void 0===e?void 0:e.notification;b.viewing&&"comment"==(null==e?void 0:e.content_type)&&e.body.hasOwnProperty("comment_id")&&N&&h.current&&(d(J.sM()),h.current.scrollIntoView(!1),h.current.classList.add("bg-yellow-200"),setTimeout(function(){h.current&&h.current.classList.remove("bg-yellow-200")},5e3))},[b.viewing,h,N]);var w=function(e){(0,X.k)((0,U.Di)(a.id),{},function(e){return o()},function(e){return console.log(e)},X.Y.DELETE,(0,V.XW)())},m=W.useState(null),k=P()(m,2),m=k[0],C=k[1],_=(Boolean(m),(0,V.Fc)());console.log("comment>>>>>>>>>>>>>>>>>>>>>>>>>>>",a);var D,k=a.text.indexOf(" ",a.text.indexOf(" ")+1),m=a.text.substring(0,k);return W.createElement("div",{key:a.id,ref:(null===(k=b.notificationData)||void 0===k||null===(t=k.notification)||void 0===t?void 0:t.object_id)==a.id?h:null},W.createElement(S.Z,{className:"px-0 items-start"},f?W.createElement("div",{className:"flex-1 w-full"},W.createElement(T.Z,{elevation:0,className:"w-full relative post-icons"},W.createElement(O.Z,{className:"pl-12 pr-80 py-8 w-full border-1 comment-area",classes:{root:"text-base"},placeholder:u("ADD_COMMENT"),value:v,multiline:!0,rows:"2",margin:"none",disableUnderline:!0,onChange:function(e){return x(e.target.value)}}))):W.createElement("div",{className:"bg-white w-full"},W.createElement(R.Z,{className:"p-10 py-8 m-0 comment-p bg-post-section rounded-16 w-full",primary:W.createElement("div",{className:"flex comment-section"},W.createElement("span",{className:"text-15 font-700"},"".concat(a.author.first_name," ").concat(a.author.last_name))),secondary:W.createElement("div",{className:"text-base text-black"},W.createElement("span",{className:"font-700 mr-2"},m),W.createElement("span",null,a.text.replace(m,"")))}),W.createElement("div",{className:"posted-images comment-post-img"},W.createElement(Q,{images:a.media_set,hideNavigation:!0})),r.id==a.author.id&&W.createElement("div",{className:"actions-dropdown resize-action-btn absolute top-0 right-0 mt-8"},W.createElement(ee,{icon:W.createElement(W.Fragment,null,W.createElement(z.Z,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:function(e){e.preventDefault(),e.stopPropagation(),C(e.currentTarget)},className:"p-10"},W.createElement(H.Z,null))),outsideClick:!0},p.map(function(e){return W.createElement(L.Z,{key:e.name,selected:"Pyxis"===e.name,onClick:e.handler},W.createElement(I.Z,null,W.createElement(j.Z,null,e.icon)),W.createElement(A.Z,{variant:"inherit"}," ",u(e.name)))})))),s&&W.createElement(W.Fragment,null,a.retryOption&&!e?W.createElement(F.Z,{onClick:function(){E(!0),(0,X.k)((0,U.ns)(n.id),a.formData,function(e){E(!1),i(a.unique_code)},function(e){E(!1)},X.Y.POST,(0,V.XW)())}},"Retry"):W.createElement(Y.Z,{position:"relative",display:"inline-flex"},W.createElement(M.Z,{size:20,color:"secondary"}),W.createElement(Y.Z,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},W.createElement(B.G,{icon:G.cf$,style:{fontSize:"1.5rem"}}))))),!s&&f&&"w"!=(null==_||null===(D=_.extra)||void 0===D?void 0:D.profile.role)?W.createElement("div",{className:"flex flex-wrap items-center ml-44"},W.createElement(F.Z,{className:"mx-2",variant:"contained",onClick:function(){return g(!1)},size:"small"},W.createElement(A.Z,{className:"normal-case mx-4"},u("CANCEL"))),W.createElement(F.Z,{disabled:!v.length,onClick:function(){var e,t=new FormData,n={text:v};for(e in n)t.append(e,n[e]);(0,X.k)((0,U.rZ)(a.id),t,function(e){console.log("edited",e),l(g)},function(e){},X.Y.PUT,(0,V.XW)())},className:"mx-2",variant:"contained",size:"small",color:"secondary"},W.createElement(A.Z,{className:"normal-case mx-4"},u("SAVE")))):W.createElement("div",{className:"flex items-center ml-44 mb-8"},W.createElement(F.Z,{onClick:c,size:"small",className:"normal-case"},W.createElement(j.Z,{className:"text-13",color:"action"},"reply_outlined"),W.createElement(A.Z,{className:"normal-case text-13 ml-4"},u("REPLY"))),W.createElement(A.Z,{className:"mx-6 text-13",variant:"caption"},q().parseZone(a.created_date).fromNow())))}}}]);