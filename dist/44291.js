(self.webpackChunkfuse_react_app=self.webpackChunkfuse_react_app||[]).push([[44291],{44291:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return l}});var t=a(56156),n=a.n(t),t=a(61432),w=a.n(t),S=a(35923),N=(a(65129),a(96282)),C=a(41533),A=a(82186),j=a(71871),k=a(13786),x=a(65087),t=a(78279),P=a.n(t),L=a(78709),M=a(58913),Z=a(92505),F=a(55110),I=a(78278),q=a(11208),W=a(3089),G=a(88572),V=a(53369),H=a(90);function r(t,e){var a,n=Object.keys(t);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(t),e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)),n}function R(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach(function(e){n()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var z={id:"",title:"",notes:"",startDate:new Date,dueDate:new Date,completed:!1,starred:!1,important:!1,deleted:!1,labels:[]};function l(e){var t=(0,V.$)("todo_project").t,a=(0,M.I0)(),n=(0,M.v9)(function(e){return e.todoAppNote.todos.todoDialog}),r=((0,M.v9)(function(e){return e.contactsApp.contacts.approvedCompanies}),(0,L.useState)(null)),l=w()(r,2),o=(l[0],l[1],(0,S.cI)(R({},z))),i=o.form,c=o.handleChange,s=o.setForm,d=o.resetForm,r=(P()(i.startDate).format(P().HTML5_FMT.DATETIME_LOCAL_SECONDS),P()(i.dueDate).format(P().HTML5_FMT.DATETIME_LOCAL_SECONDS),(0,L.useState)([])),l=w()(r,2),o=(l[0],l[1],(0,L.useState)([])),r=w()(o,2),l=r[0],u=r[1],o=(0,L.useState)([]),r=w()(o,2),m=r[0],f=r[1],p=(0,M.v9)(function(e){e=e.chatApp;return null==e?void 0:e.company}),o=(0,L.useState)("to-do"),r=w()(o,2),v=r[0],E=r[1],o=(0,L.useState)(!1),r=w()(o,2),o=r[0],b=r[1],D=(0,F.UO)(),r=(0,L.useState)({startDate:new Date,endDate:void 0}),r=w()(r,2),y=r[0],O=r[1];(0,L.useEffect)(function(){if(n.props.openTimelineDialog)return s(R(R({},n.data.todo),{},{notes:n.data.todo.description})),T(),O({startDate:new Date(n.data.todo.datetime_start),endDate:new Date(n.data.todo.datetime_end)}),E(n.data.todo.status),f(n.data.todo.workers.map(function(e){return{data:e,value:g(e),label:L.createElement("span",{className:"flex items-center pl-12"},g(e))}})),function(){d()}},[]);function _(e){return"".concat(e.profile.first_name," ").concat(e.profile.last_name)}var T=function(e){(0,G.k)((0,q.GL)(D.id,n.data.task.assigned_company.id,e),{},function(e){return u(e)},function(e){return console.log(e)},G.Y.GET,(0,W.XW)())},h=(0,W.Fc)(),g=function(e){return"".concat(e.first_name," ").concat(e.last_name)},r=function(){var e,t;return(null===(e=n.data)||void 0===e?void 0:e.task)&&n.data.task.assigned_company.id!=p.id||"w"==(null==h||null===(t=h.extra)||void 0===t?void 0:t.profile.role)};return L.createElement("div",{className:"sm:pl-10"},r()&&L.createElement("div",{className:"flex items-center mb-24"},L.createElement(N.Z,null,"lock")," only company owner can change this details"),L.createElement(C.Z,{className:"mt-8 mb-24",required:!0,fullWidth:!0},L.createElement(A.Z,{label:t("TASK_TITLE"),autoFocus:!0,name:"title",value:i.title,onChange:c,required:!0,variant:"outlined",disabled:r()})),L.createElement(Z.default,{placeholder:t("SELECT_PROFILE"),variant:"fixed",isMulti:!0,textFieldProps:{label:"Profile",InputLabelProps:{shrink:!0},variant:"outlined"},onChange:function(e){f(e)},value:m,options:l.map(function(e){return{data:e,value:_(e),label:L.createElement("span",{className:"flex items-center"},_(e))}}),className:"select-dropdown mb-16",isDisabled:r()}),L.createElement(C.Z,{className:"mt-8 mb-16",required:!0,fullWidth:!0},L.createElement(A.Z,{label:t("NOTES"),name:"notes",multiline:!0,rows:"4",value:i.notes,onChange:c,variant:"outlined",disabled:r()})),L.createElement("div",{className:"flex -mx-4"},L.createElement("div",{className:"mt-8 mb-16 mx-4 relative static-form-label flex-1"},L.createElement(I.e,{label:t("START_DATE"),inputVariant:"outlined",format:"DD/MM/yyyy",value:y.startDate,onChange:function(e){O(R(R({},y),{},{startDate:e}))},className:"mt-8 mb-16 w-full",disabled:r()})),L.createElement("div",{className:"mt-8 mb-16 mx-4 relative static-form-label flex-1"},L.createElement(I.e,{label:t("END_DATE"),inputVariant:"outlined",format:"DD/MM/yyyy",value:y.endDate,onChange:function(e){O(R(R({},y),{},{endDate:e}))},className:"mt-8 mb-16 w-full",disabled:r(),minDate:y.startDate}))),L.createElement(C.Z,{className:"mt-8 mb-16",variant:"outlined",required:!0,fullWidth:!0},L.createElement(j.Z,{disabled:r(),native:!0,value:v,onChange:function(e){return E(e.target.value)}},L.createElement("option",{value:"to-do"},t("TO_DO_STATE")),L.createElement("option",{value:"completed"},t("COMPLETED_STATE")))),L.createElement("div",{className:"flex justify-end"},L.createElement(k.Z,{variant:"contained",color:"primary",onClick:function(){b(!0),a(H.yv(R(R({},i),{},{id:n.data.todo.id,profile:m,progress:v},y),D.id,b,n.data.isGantt))},disabled:r()},t("SAVE")," ",o&&L.createElement(x.Z,{size:15,color:"secondary"}))))}}}]);