(self.webpackChunkfuse_react_app=self.webpackChunkfuse_react_app||[]).push([[91454],{92505:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var t=n(56156),a=n.n(t),t=n(20305),l=n.n(t),t=n(51265),r=n.n(t),o=n(78709),t=n(40962),i=n(389),c=n(92466),s=n(82186),u=n(41713),d=n(23610),p=n(86926),m=n(28344),f=n(67485),v=n(94435);function b(t,e){var n,a=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)),a}var g=(0,t.Z)(function(e){return{root:{"& .fuse-chip-select__input":{color:e.palette.text.primary},"&.standard":{"& $placeholder":{},"& $valueContainer":{paddingTop:4}},"&.filled":{"& $placeholder":{left:12},"& $valueContainer":{paddingTop:24,paddingLeft:12},"& $chip":{border:"1px solid rgba(0, 0, 0, 0.12)"}},"&.outlined":{"& $placeholder":{left:12},"& $valueContainer":{paddingLeft:12,paddingTop:12}}},input:{display:"flex",padding:0,height:"auto"},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",paddingBottom:4,paddingTop:12,minHeight:40},chip:{margin:"4px 4px 4px 0"},chipFocused:{backgroundColor:(0,i.emphasize)("light"===e.palette.type?e.palette.grey[300]:e.palette.grey[700],.08)},noOptionsMessage:{padding:"".concat(e.spacing(),"px ").concat(e.spacing(2),"px")},singleValue:{fontSize:16},placeholder:{position:"absolute",left:0,fontSize:16,margin:0},paper:{position:"absolute",zIndex:2,marginTop:e.spacing(),left:0,right:0},divider:{height:e.spacing(2)}}});function h(e){var t=e.inputRef,e=l()(e,["inputRef"]);return o.createElement("div",r()({ref:t},e))}var E={Control:function(e){var t=g();return o.createElement(s.Z,r()({fullWidth:!0,className:(0,m.Z)(t.root,e.selectProps.textFieldProps.variant),required:e.selectProps.required,error:e.selectProps.error,InputProps:{inputComponent:h,inputProps:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach(function(e){a()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({className:t.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.textFieldProps))},Menu:function(e){var t=g();return o.createElement(p.Z,r()({square:!0,className:t.paper},e.innerProps),e.children)},MultiValue:function(t){var e=g();return o.createElement(d.Z,{tabIndex:-1,label:t.children,className:(0,m.Z)(e.chip,a()({},e.chipFocused,t.isFocused),t.data.class),onDelete:function(e){t.removeProps.onClick(),t.removeProps.onMouseDown(e)}})},NoOptionsMessage:function(e){var t=g();return o.createElement(c.Z,r()({color:"textSecondary",className:t.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return o.createElement(u.Z,r()({buttonRef:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?600:400}},e.innerProps),e.children)},Placeholder:function(e){var t=g();return o.createElement(c.Z,r()({color:"textSecondary",className:t.placeholder},e.innerProps),e.children)},SingleValue:function(e){var t=g();return o.createElement(c.Z,r()({className:t.singleValue},e.innerProps),e.children)},ValueContainer:function(e){var t=g();return o.createElement("div",{className:t.valueContainer},e.children)}};function x(t){function e(e){null===e&&(e=[]),t.onChange&&t.onChange(e)}return"fixed"===t.variant?o.createElement(f.ZP,r()({classNamePrefix:"fuse-chip-select"},t,{components:E,onChange:e})):o.createElement(v.ZP,r()({classNamePrefix:"fuse-chip-select"},t,{components:E,onChange:e}))}var y=o.memo(x)},91454:function(e,t,n){"use strict";n.r(t);var a=n(56156),l=n.n(a),r=n(79545),S=n.n(r),o=n(61432),T=n.n(o),i=n(51265),I=n.n(i),c=n(20305),s=n.n(c),u=n(16526),a=n.n(u),r=n(32986),A=n(92505),M=n(35923),d=(n(65129),n(1644)),L=n(92466),o=n(40962),i=n(6274),c=n(12303),F=n(96282),R=n(70310),z=n(61681),V=n(48258),$=n(80896),G=n(82186),q=n(92571),W=n(13786),H=n(65087),u=n(78279),U=n.n(u),X=n(78709),B=n(58913),Y=n(78278),J=n(55110),K=n(7074),Q=n(3089),ee=n(53369),te=n(35965);function p(t,e){var n,a=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)),a}function ne(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach(function(e){l()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var ae=(0,r.ZP)(function(){return Promise.all([n.e(66066),n.e(12420)]).then(n.bind(n,69796))}),le=(0,r.ZP)(function(){return Promise.all([n.e(38192),n.e(52624)]).then(n.bind(n,52624))});(0,r.ZP)(function(){return Promise.all([n.e(62475),n.e(10930),n.e(79337),n.e(4330),n.e(69293)]).then(n.bind(n,4330))});function re(e){var t=e.children,n=e.value,a=e.index,e=s()(e,["children","value","index"]);return X.createElement("div",I()({role:"tabpanel",hidden:n!==a,id:"wrapped-tabpanel-".concat(a),"aria-labelledby":"wrapped-tab-".concat(a)},e),n===a&&X.createElement(d.Z,{p:3},X.createElement(L.Z,null,t)))}function oe(e){return{id:"wrapped-tab-".concat(e),"aria-controls":"wrapped-tabpanel-".concat(e)}}re.propTypes={children:a().node,index:a().any.isRequired,value:a().any.isRequired};(0,o.Z)(function(e){return{root:{flexGrow:1,minHeight:"100%",backgroundColor:e.palette.background.paper}}});var ie=[{value:0},{value:10},{value:20},{value:30},{value:40},{value:50},{value:60},{value:70},{value:80},{value:90},{value:100}],o="0 3px 1px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.13),0 0 0 1px rgba(0,0,0,0.02)",ce=(0,i.Z)({root:{color:"#3880ff",height:2,padding:"15px 0"},thumb:{height:28,width:28,backgroundColor:"#fff",boxShadow:o,marginTop:-14,marginLeft:-14,"&:focus, &:hover, &$active":{boxShadow:"0 3px 1px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.3),0 0 0 1px rgba(0,0,0,0.02)","@media (hover: none)":{boxShadow:o}}},active:{},valueLabel:{left:"calc(-50% + 12px)",top:-22,"& *":{background:"transparent",color:"#000"}},track:{height:2},rail:{height:2,opacity:.5,backgroundColor:"#bfbfbf"},mark:{backgroundColor:"#bfbfbf",height:8,width:1,marginTop:-3},markActive:{opacity:1,backgroundColor:"currentColor"}})(c.Z);t.default=function(e){function t(e){return"".concat(e.first_name," ").concat(e.last_name)}var n=(0,ee.$)("dashboard").t,a=(0,B.I0)(),l=(0,B.v9)(function(e){return e.todoApp.todos.upload}),r=(0,B.v9)(function(e){return e.todoApp.todos.taskContentDialog}),o=(0,B.v9)(function(e){return null===(e=e.todoApp.todos.taskContentDialog)||void 0===e?void 0:e.data}),i=(0,B.v9)(function(e){return e.todoAppNote.todos.openDrawingContent}),c=(0,B.v9)(function(e){return e.contactsApp.contacts.approvedCompanies}),s=(0,X.useState)([]),u=(g=T()(s,2))[0],d=g[1],p=(0,X.useState)([]),m=(x=T()(p,2))[0],f=(x[1],(0,X.useState)([])),v=(s=T()(f,2))[0],b=s[1],g=(0,X.useState)(0),h=(p=T()(g,2))[0],E=p[1],x=(0,X.useState)(!1),s=(f=T()(x,2))[0],y=f[1],P=(0,J.UO)(),w=(0,B.v9)(function(e){e=e.chatApp;return null==e?void 0:e.company}),g=null==o?void 0:o.project,p=(0,X.useState)({startDate:new Date,endDate:void 0}),N=(x=T()(p,2))[0],D=x[1],f=X.useState(0),x=(p=T()(f,2))[0],C=p[1];function O(){var e;return null==Z||null===(e=Z.extra)||void 0===e?void 0:e.profile.role}(0,X.useEffect)(function(){i&&(C(1),oe(1))},[i]),(0,X.useEffect)(function(){var e;c&&c.length&&o&&(e=S()(c).filter(function(e){var t,n;return(null===(e=e.profile)||void 0===e||null===(t=e.company)||void 0===t?void 0:t.id)==(null==o||null===(n=o.assigned_company)||void 0===n?void 0:n.id)}).map(function(e){var t,n;return{data:e,value:null===(t=e.profile)||void 0===t||null===(n=t.company)||void 0===n?void 0:n.name,label:X.createElement("span",{className:"flex items-center"},X.createElement(F.Z,{className:"list-item-icon mx-6 text-20",style:{color:null===(n=e.profile.company)||void 0===n?void 0:n.color_project},color:"action"},"label")," ",e.profile.company.name)}}),b(e)),o&&(console.log({taskContentData:o,date_start:o.date_start}),o.isGantt&&1==o.parent?(D({startDate:new Date(o.datetime_start),endDate:new Date(o.datetime_end)}),E(o.progress),d(o.workers.map(function(e){return{data:e,value:t(e),label:X.createElement("span",{className:"flex items-center"},t(e))}})),_()):(D({startDate:new Date(o.date_start),endDate:new Date(o.date_end)}),E(o.progress),b([{data:o.assigned_company}])))},[c,o]),(0,X.useEffect)(function(){C(0)},[o]);var Z=(0,Q.Fc)(),k=(f=(0,M.cI)({name:1==(null==o?void 0:o.parent)?null==o?void 0:o.title:null==o?void 0:o.name,description:1==(null==o?void 0:o.parent)?null==o?void 0:o.description:null==o?void 0:o.note})).form,p=f.handleChange,j=(f.setForm,f.setInForm);k&&k.due&&U()(k.due).format(U().HTML5_FMT.DATE),(0,X.useCallback)(function(e,t){j("checklists[".concat(t,"]"),e)},[j]),f=function(){var e;return(null==o||null===(e=o.assigned_company)||void 0===e?void 0:e.id)!=w.id||"w"==O()||"m"==O()},console.log({getIsDisabled:f(),projectDetail:g,companyDetail:w.id,getRole:O()});var _=function(e){console.log(P.id,o,e)};return X.createElement("div",{className:"w-full custom-task-content"},X.createElement("div",{className:"custom-tab-header2 bg-white h-64 flex relative"},X.createElement(R.Z,{value:x,onChange:function(e,t){C(t)},showLabels:!0,className:"w-full h-64"},X.createElement(z.Z,I()({className:"min-w-auto max-w-full font-bold",label:"Contents",wrapped:!0},oe(0))),X.createElement(z.Z,I()({className:"min-w-auto max-w-full font-bold",label:"Edit"},oe(2)))),X.createElement("div",{className:"absolute right-m-12"},X.createElement(V.Z,{onClick:function(e){return a(K.X_())},edge:"start",color:"inherit","aria-label":"close",className:"close-icon"},X.createElement(te.Z,null))),!(null==l||!l.isUploading)&&X.createElement("div",{className:"linear-progress custom-color"},X.createElement(ae,{progress:l.uploadPercentage,label:n("PROCESSING_UPLOADING_POST")}))),X.createElement("div",{className:"my-24 todo-bg-footer p-12 px-20 rounded"},(null==o?void 0:o.project)&&X.createElement(L.Z,{variant:"h6",color:"inherit",className:"font-size-14 "},X.createElement("div",null,null==o?void 0:o.project.name)),X.createElement("div",{className:"flex items-center font-weight-700 font-size-18"},X.createElement("div",{className:"my-4"},null==o?void 0:o.name," "))),X.createElement($.Z,{id:"dialog-content",className:"p-0"},X.createElement(re,{value:x,index:0,class:"write-post-img-full"},X.createElement(le,{taskId:null==o?void 0:o.id,isTask:!0})),X.createElement(re,{value:x,index:1,className:"bg-white"},X.createElement("div",{className:"sm:mx-12"},f()&&X.createElement("div",{className:"flex items-center mb-24"},X.createElement(F.Z,null,"lock")," only company owner can change this details"),X.createElement("div",{className:"flex items-center mb-24"},X.createElement(G.Z,{label:n("TITLE"),disabled:f(),type:"text",name:"name",variant:"outlined",value:k.name,onChange:p,fullWidth:!0,required:!0,InputProps:{endAdornment:X.createElement(q.Z,{position:"end"},X.createElement(F.Z,{className:"text-20",color:"action"},"remove_red_eye"))}})),null!=o&&o.isGantt&&1==(null==o?void 0:o.parent)?X.createElement("div",{className:"mt-8 mb-16 select-dropdown"},X.createElement(A.default,{isDisabled:f(),placeholder:n("SELECT_PROFILE"),variant:"fixed",isMulti:!0,textFieldProps:{label:"Profile",InputLabelProps:{shrink:!0},variant:"outlined"},onChange:function(e){d(e.splice(e.length-1))},value:u,options:m.map(function(e){return{data:e,value:t(e),label:X.createElement("span",{className:"flex items-center"},t(e))}})})):c&&!!c.length&&X.createElement("div",{className:"mt-8 mb-16 select-dropdown"},X.createElement(A.default,{className:"",placeholder:n("SELECT_COMPANY"),isDisabled:f(),variant:"fixed",isMulti:!0,textFieldProps:{label:"Company",InputLabelProps:{shrink:!0},variant:"outlined"},onChange:function(e){b(e.splice(e.length-1))},value:v,options:c.map(function(e){return{data:e,value:e.company,label:X.createElement("span",{className:"flex items-center"},X.createElement(F.Z,{className:"list-item-icon mx-6 text-20",style:{color:e.color},color:"action"},"label")," ",e.company)}})})),X.createElement("div",{className:"w-full mb-24"},X.createElement(G.Z,{label:n("DESCRIPTION"),name:"description",value:k.description,disabled:f(),onChange:p,multiline:!0,rows:"4",variant:"outlined",fullWidth:!0})),X.createElement("div",{className:"flex -mx-4"},X.createElement("div",{className:"mt-8 mb-16 mx-4 relative static-form-label flex-1"},X.createElement(Y.e,{label:n("START_DATE"),inputVariant:"outlined",format:"DD/MM/yyyy",value:N.startDate,onChange:function(e){D(ne(ne({},N),{},{startDate:e}))},className:"mt-8 mb-16 w-full"})),X.createElement("div",{className:"mt-8 mb-16 mx-4 relative static-form-label flex-1"},X.createElement(Y.e,{label:n("END_DATE"),inputVariant:"outlined",format:"DD/MM/yyyy",value:N.endDate,onChange:function(e){D(ne(ne({},N),{},{endDate:e}))},className:"mt-8 mb-16 w-full",disabled:f(),minDate:N.startDate}))),null!=o&&o.isGantt&&1==(null==o?void 0:o.parent)?null:X.createElement("div",{className:"mt-24 mx-12 zoom-125"},X.createElement(ce,{"aria-label":"ios slider",disabled:f(),defaultValue:0,marks:ie,onChange:function(e,t){return E(t)},value:h,valueLabelDisplay:"on"})),X.createElement("div",{className:"flex justify-end mt-16"},X.createElement(W.Z,{"aria-label":"save",variant:"contained",color:"secondary",type:"submit",size:"small",disabled:!(k.name&&0<k.name.length&&N.startDate&&N.endDate)||f(),onClick:f()?function(){return""}:function(){y(!0),a(K.bm(ne(ne({},k),{},{id:o.id,company:v,profile:u,progress:h},N),o.project.id,r.type,function(){a(K.X_())},o.isGantt,y))}},n("SAVE")," ",s&&X.createElement(H.Z,{size:15,color:"secondary"})))))))}}}]);