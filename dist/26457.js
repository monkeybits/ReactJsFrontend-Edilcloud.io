(self.webpackChunkfuse_react_app=self.webpackChunkfuse_react_app||[]).push([[26457],{26457:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});function R(n,i){var o,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"brush",r=!1;n.on("mousedown touchstart",function(e){r=!0;var t=n.scaleX(),t={x:n.getPointerPosition().x/t-n.x()/t,y:n.getPointerPosition().y/t-n.y()/t};o=new(c().Line)({stroke:"brush"==a?"red":"white",strokeWidth:"brush"==a?5:20,globalCompositeOperation:"brush"===a?"source-over":"destination-out",points:[t.x,t.y],draggable:"brush"==a}),i.add(o)}),n.on("mouseup touchend",function(){r=!1}),n.on("mousemove touchmove",function(){var e;r&&(e=n.scaleX(),e={x:n.getPointerPosition().x/e-n.x()/e,y:n.getPointerPosition().y/e-n.y()/e},e=o.points().concat([e.x,e.y]),o.points(e),i.batchDraw())})}var i=n(61432),D=n.n(i),N=(n(65129),n(99904)),I=n(70964),L=n(84403),X=n(95272),U=n(48258),F=n(96282),W=n(80896),_=n(28103),z=n(13786),H=n(19462),M=n(78709),O=n(14252),t=n(32986),i=n(48346),c=n.n(i),T=(n(95679),(0,t.ZP)(function(){return n.e(64792).then(n.bind(n,64792))})),Y=n(95679);var o=function(e){var t=e.open,n=e.onClose,i=e.imgSrc,o=(e.replaceUrl,e.width,e.height,(0,M.useState)([1])),a=(c=D()(o,2))[0],r=c[1],e=(0,M.useState)([0]),c=(o=D()(e,2))[0],l=o[1],e=(0,M.useState)([0]),e=(o=D()(e,2))[0],s=o[1],o=(0,M.useState)([]),u=(o=D()(o,2))[0],d=o[1],o=(0,M.useState)([]),f=(o=D()(o,2))[0],m=o[1],o=(0,M.useState)([]),g=(o=D()(o,2))[0],p=o[1],o=(0,M.useState)(null),h=(o=D()(o,2))[0],v=o[1],o=(0,M.useState)([]),y=(o=D()(o,2))[0],x=o[1],o=M.useState(),P=D()(o,2)[1],E=M.createRef(),w=M.createRef(),S=M.createRef(),o=(M.useRef(),(0,M.useState)({height:0,width:0})),Z=(o=D()(o,2))[0],k=o[1],b=M.useCallback(function(){return P({})},[]);(0,M.useEffect)(function(){var e=Y();return g.push({content:i,id:e}),p(g),y.push(e),x(y),b(),function(){x([]),p([])}},[i]),M.useEffect(function(){console.log("image",Z)},[Z]);var C=function(e,t){var n=document.createElement("a");n.download=t,n.href=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)};return document.addEventListener("keydown",function(e){"Delete"==e.code&&(-1!=(e=f.findIndex(function(e){return e.id==h}))&&(f.splice(e,1),m(f)),-1!=(e=u.findIndex(function(e){return e.id==h}))&&(u.splice(e,1),d(u)),-1!=(e=g.findIndex(function(e){return e.id==h}))&&(g.splice(e,1),p(g)),b())}),M.createElement(M.Fragment,null,M.createElement(N.Z,{open:t,onClose:n,fullWidth:!0,className:"rs-dialog-sm-full zoom-125 custom-drawing-modal"},M.createElement(I.Z,{component:"div",className:"p-0"},M.createElement(L.Z,{position:"static",elevation:1},M.createElement(X.Z,{className:"flex w-full overflow-x-auto px-8 sm:px-16"},M.createElement("div",{className:"flex flex-1"},M.createElement("div",{className:"my-12"},M.createElement("div",{className:"font-size-18"},"Drawing"))),M.createElement(U.Z,{color:"inherit"},M.createElement(F.Z,null,"close"))))),M.createElement(W.Z,{id:"dialog-content",className:"p-0 sm:p-10"},M.createElement(_.Z,{className:"mb-12"},M.createElement(z.Z,{variant:"primary",onClick:function(){v(null),R(E.getStage(),w.current)}},"Line"),M.createElement(z.Z,{variant:"primary",onClick:function(){R(E.getStage(),w.current,"erase")}},"Erase"),M.createElement(z.Z,{variant:"primary",onClick:function(){var t=y[y.length-1],e=f.findIndex(function(e){return e.id==t});-1!=e&&(f.splice(e,1),m(f)),-1!=(e=u.findIndex(function(e){return e.id==t}))&&(u.splice(e,1),d(u)),-1!=(e=g.findIndex(function(e){return e.id==t}))&&(g.splice(e,1),p(g)),y.pop(),x(y),b()}},"Undo"),M.createElement(z.Z,{style:{marginRight:"3px"},variant:"primary",onClick:function(){var e=E.scaleX(),t=E.getStage(),n=1.01*e,i=t.getPointerPosition().x/e-t.x()/e,e=t.getPointerPosition().y/e-t.y()/e;r(n),l(-(i-t.getPointerPosition().x/n)*n),s(-(e-t.getPointerPosition().y/n)*n),b()}},"ZoomIn +"),M.createElement(z.Z,{style:{marginRight:"3px"},variant:"primary",onClick:function(){var e=E.scaleX(),t=E.getStage(),n=e/1.01,i=t.getPointerPosition().x/e-t.x()/e,e=t.getPointerPosition().y/e-t.y()/e;r(n),l(-(i-t.getPointerPosition().x/n)*n),s(-(e-t.getPointerPosition().y/n)*n),b()}},"Zoom Out -")),M.createElement("input",{style:{display:"none"},type:"file",ref:S,onChange:function(e){var e=e.target.files[0],t=new FileReader;t.addEventListener("load",function(){var e=Y();g.push({content:t.result,id:e}),p(g),S.current.value=null,y.push(e),x(y),b()},!1),e&&t.readAsDataURL(e)}}),M.createElement(O.Hf,{style:{overFlow:"scroll",background:"#DFD9D9"},width:Z.width,height:Z.height,onWheel:function(e){e.evt.preventDefault();var t=e.target.getStage(),n=t.scaleX(),i=t.getPointerPosition().x/n-t.x()/n,o=t.getPointerPosition().y/n-t.y()/n,n=0<e.evt.deltaY?1.01*n:n/1.01;r(n),l(-(i-t.getPointerPosition().x/n)*n),s(-(o-t.getPointerPosition().y/n)*n)},scaleX:a,scaleY:a,x:c,y:e,ref:function(e){E=e},onMouseDown:function(e){e.target===e.target.getStage()&&v(null)}},M.createElement(O.mh,{ref:w},g.map(function(e,t){return M.createElement(T,{key:t,imageUrl:e.content,isSelected:e.id===h,onSelect:function(){v(e.id)},saveImageWidthHeight:function(e){k({width:e.width,height:e.height})},onChange:function(e){g.slice()[t]=e},getMyRef:function(e){return e},imageProps:Z})})))),M.createElement(H.Z,{className:"p-16 px-20"},M.createElement(z.Z,{variant:"contained",color:"primary",onClick:function(){setTimeout(function(){r(1),l(1),s(1),b(),setTimeout(function(){var e=E.getStage().toDataURL({pixelRatio:3});C(e,"stage.png"),n()},100)},400)}},"save"))))}}}]);