(self.webpackChunkfuse_react_app=self.webpackChunkfuse_react_app||[]).push([[56086],{92505:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var t=n(56156),r=n.n(t),t=n(20305),a=n.n(t),t=n(51265),o=n.n(t),i=n(78709),t=n(40962),l=n(389),c=n(92466),u=n(82186),s=n(41713),d=n(23610),p=n(86926),f=n(28344),m=n(67485),O=n(94435);function D(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}var P=(0,t.Z)(function(e){return{root:{"& .fuse-chip-select__input":{color:e.palette.text.primary},"&.standard":{"& $placeholder":{},"& $valueContainer":{paddingTop:4}},"&.filled":{"& $placeholder":{left:12},"& $valueContainer":{paddingTop:24,paddingLeft:12},"& $chip":{border:"1px solid rgba(0, 0, 0, 0.12)"}},"&.outlined":{"& $placeholder":{left:12},"& $valueContainer":{paddingLeft:12,paddingTop:12}}},input:{display:"flex",padding:0,height:"auto"},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",paddingBottom:4,paddingTop:12,minHeight:40},chip:{margin:"4px 4px 4px 0"},chipFocused:{backgroundColor:(0,l.emphasize)("light"===e.palette.type?e.palette.grey[300]:e.palette.grey[700],.08)},noOptionsMessage:{padding:"".concat(e.spacing(),"px ").concat(e.spacing(2),"px")},singleValue:{fontSize:16},placeholder:{position:"absolute",left:0,fontSize:16,margin:0},paper:{position:"absolute",zIndex:2,marginTop:e.spacing(),left:0,right:0},divider:{height:e.spacing(2)}}});function E(e){var t=e.inputRef,e=a()(e,["inputRef"]);return i.createElement("div",o()({ref:t},e))}var T={Control:function(e){var t=P();return i.createElement(u.Z,o()({fullWidth:!0,className:(0,f.Z)(t.root,e.selectProps.textFieldProps.variant),required:e.selectProps.required,error:e.selectProps.error,InputProps:{inputComponent:E,inputProps:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(Object(n),!0).forEach(function(e){r()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({className:t.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.textFieldProps))},Menu:function(e){var t=P();return i.createElement(p.Z,o()({square:!0,className:t.paper},e.innerProps),e.children)},MultiValue:function(t){var e=P();return i.createElement(d.Z,{tabIndex:-1,label:t.children,className:(0,f.Z)(e.chip,r()({},e.chipFocused,t.isFocused),t.data.class),onDelete:function(e){t.removeProps.onClick(),t.removeProps.onMouseDown(e)}})},NoOptionsMessage:function(e){var t=P();return i.createElement(c.Z,o()({color:"textSecondary",className:t.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return i.createElement(s.Z,o()({buttonRef:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?600:400}},e.innerProps),e.children)},Placeholder:function(e){var t=P();return i.createElement(c.Z,o()({color:"textSecondary",className:t.placeholder},e.innerProps),e.children)},SingleValue:function(e){var t=P();return i.createElement(c.Z,o()({className:t.singleValue},e.innerProps),e.children)},ValueContainer:function(e){var t=P();return i.createElement("div",{className:t.valueContainer},e.children)}};function v(t){function e(e){null===e&&(e=[]),t.onChange&&t.onChange(e)}return"fixed"===t.variant?i.createElement(m.ZP,o()({classNamePrefix:"fuse-chip-select"},t,{components:T,onChange:e})):i.createElement(O.ZP,o()({classNamePrefix:"fuse-chip-select"},t,{components:T,onChange:e}))}var g=i.memo(v)},90:function(e,t,n){"use strict";n.d(t,{WL:function(){return P},bP:function(){return T},O0:function(){return r},_V:function(){return S},Wy:function(){return A},Xg:function(){return G},t7:function(){return C},r8:function(){return v},rv:function(){return R},p2:function(){return M},uq:function(){return g},lt:function(){return y},Hz:function(){return pe},D4:function(){return fe},y$:function(){return a},Im:function(){return _},s8:function(){return b},kK:function(){return k},__:function(){return h},sJ:function(){return O},X1:function(){return x},JV:function(){return w},Wo:function(){return D},AS:function(){return E},hN:function(){return m},cS:function(){return Y},TF:function(){return c},W6:function(){return L},VL:function(){return I},v0:function(){return N},Iu:function(){return i},Tu:function(){return o},t:function(){return $},$U:function(){return H},rk:function(){return ce},P7:function(){return f},Bl:function(){return le},ue:function(){return X},a7:function(){return ie},Ln:function(){return re},hg:function(){return Q},Br:function(){return te},X_:function(){return z},aP:function(){return ae},yv:function(){return ue},Kj:function(){return se},bm:function(){return de},LC:function(){return W},Yp:function(){return ne},Am:function(){return oe},NJ:function(){return V},fE:function(){return K},Z$:function(){return B},ru:function(){return ee},tp:function(){return U},F8:function(){return q},K4:function(){return J},VX:function(){return j},iw:function(){return F}});n(56156),n(31806);var u=n(88572),s=n(11208),d=n(3089),t=n(78279),p=n.n(t),l=n(43812),r="[TODO APP] CHANGE FILTERS(project)";function f(t){return function(e){return e({type:r,payload:t})}}var a="[TODO APP] GET TODOS (PROJECT)",m="[TODO APP] RESET ALL FILTERS (PROJECT)",o="[TODO APP] UPDATE TODOS (PROJECT)",i="[TODO APP] UPDATE TODO (PROJECT)",c="[TODO APP] SET SEARCH TEXT (PROJECT)",O="[TODO APP] OPEN NEW TODO DIALOG (PROJECT)",D="[TODO APP] OPEN TASK CONTENT DIALOG (PROJECT)",P="[TODO APP] ADD TASK CONTENT DATA (PROJECT)",E="[TODO APP] OPEN TIMELINE DIALOG (PROJECT)",T="[TODO APP] ADD TIMELINE DATA (PROJECT)",v="[TODO APP] CLOSE NEW TODO DIALOG (PROJECT)",g="[TODO APP] CLOSE TASK CONTENT DIALOG (PROJECT)",y="[TODO APP] CLOSE TIMELINE DIALOG (PROJECT)",h="[TODO APP] OPEN EDIT TODO DIALOG (PROJECT)",b="[TODO APP] OPEN ACTIVITY TODO DIALOG (PROJECT)",C="[TODO APP] CLOSE EDIT TODO DIALOG (PROJECT)",A="[TODO APP] CLOSE ACTIVITY TODO DIALOG (PROJECT)",N="[TODO APP] TOGGLE ORDER DESCENDING (PROJECT)",S="[TODO APP] CHANGE ORDER (PROJECT)",L="[TODO APP] SET UPLOAD (PROJECT)",I="[TODO APP] SET UPLOAD PERCENTAGE (PROJECT)",Y="[TODO APP] SET LOADING (PROJECT)",x="[TODO APP] OPEN NOTIFICATION DIALOG (PROJECT)",R="[TODO APP] CLOSE NOTIFICATION DIALOG (PROJECT)",w="[TODO APP] OPEN STATUS CONFIRM DIALOG (PROJECT)",M="[TODO APP] CLOSE STATUS CONFIRM DIALOG (PROJECT)",_="[TODO APP] OK STATUS CONFIRM DIALOG (PROJECT)",k="[TODO APP] OPEN DRAWING CONTENT DIALOG (PROJECT)",G="[TODO APP] CLOSE DRAWING CONTENT DIALOG (PROJECT)";function Z(e,t){return e.id>t.id?1:e.id<t.id?-1:0}function J(e){return{type:Y,payload:e}}function j(e){return{type:L,payload:e}}function F(e){return{type:I,payload:e}}function W(e,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){return""};return console.log({pid:e,isGantt:n,handleSetLoading:r}),r({loadingTodos:!0}),function(t){t(J(!0)),(0,u.k)((n?(0,s.B1):(0,s.sM))(e),{},function(e){r({loadingTodos:!1}),t(J(!1)),t({type:a,payload:e.sort(Z),isGantt:n})},function(e){r({loadingTodos:!1}),t(J(!1)),console.log(e)},u.Y.GET,(0,d.XW)())}}function U(e){return{type:D,data:e}}function V(e){return{type:k,data:e}}function X(){return{type:G}}function $(e){return{type:P,data:e}}function z(){return{type:g}}function K(e){return{type:O,data:e}}function q(e){return{type:E,todo:e}}function H(e){return{type:T,todo:e}}function B(e){return{type:x,data:e}}function Q(){return{type:R}}function ee(e){return{type:w,data:e}}function te(){return{type:M}}function ne(){return{type:_}}function re(){return{type:v}}function ae(){return{type:y}}function oe(t){return function(e){return e({type:b,data:t})}}function ie(){return{type:C}}function le(){return{type:A}}function ce(n,r,a,o,i){return function(t){var e="new"==a?{name:n.title,note:n.notes,progress:n.progress,date_start:p()(n.startDate).format("YYYY-MM-DD"),date_end:p()(n.endDate).format("YYYY-MM-DD"),assigned_company:n.company&&n.company[0]?n.company[0].data.profile.company.id:null}:{title:n.title,description:n.notes,datetime_start:p()(n.startDate).format("YYYY-MM-DD"),datetime_end:p()(n.endDate).format("YYYY-MM-DD"),workers:null!==(e=n.profile)&&void 0!==e&&e.length?n.profile.map(function(e){return e.data.profile.id}):null};(0,u.k)("new"==a?(0,s.Md)(r):(0,s.he)(n.id),e,function(e){i?t(W(r,i)):(t(W(r,!1)),t(W(r,!0))),o()},function(e){return console.log(e)},u.Y.POST,(0,d.XW)())}}function ue(n,r,a,o){return function(t){console.log(n,n.profile);var e={title:n.title,description:n.notes,datetime_start:p()(n.startDate).format("YYYY-MM-DD"),datetime_end:p()(n.endDate).format("YYYY-MM-DD"),status:n.progress,workers:null!==(e=n.profile)&&void 0!==e&&e.length?n.profile.map(function(e){return(e.data.profile||e.data).id}):void 0};(0,u.k)((0,s.E1)(n.id),e,function(e){o&&(t(W(r,o)),t(ae())),console.log(e),a(!1),l.Am.success("Updated")},function(e){return console.log(e)},u.Y.PUT,(0,d.XW)())}}function se(n,r,a,o,i){return function(t){console.log({todo:n});var e={title:n.name,description:n.description,datetime_start:p()(n.startDate).format("YYYY-MM-DD"),datetime_end:p()(n.endDate).format("YYYY-MM-DD"),workers:null!==(e=n.profile)&&void 0!==e&&e.length?n.profile.map(function(e){return(e.data.profile||e.data).id}):void 0};(0,u.k)((0,s.E1)(n.id),e,function(e){console.log(e),l.Am.success("Updated"),i(!1),o?t(W(r,o)):(t(W(r,!1)),t(W(r,!0))),a()},function(e){return console.log(e)},u.Y.PUT,(0,d.XW)())}}function de(r,a,o,i,l,c){return console.log({todo:r}),function(t){var e,n="new"==o?{name:r.name,note:r.description,progress:r.progress,date_start:p()(r.startDate).format("YYYY-MM-DD"),date_end:p()(r.endDate).format("YYYY-MM-DD"),assigned_company:null!==(e=r.company[0])&&void 0!==e&&(null!==(e=e.data)&&void 0!==e&&(null!==(e=e.profile)&&void 0!==e&&(null!==(n=e.company)&&void 0!==n&&n.id)))?r.company[0].data.profile.company.id:null,project:a,date_completed:null,alert:!1,starred:!1}:{title:r.title,description:r.notes,datetime_start:p()(r.startDate).format("YYYY-MM-DD"),datetime_end:p()(r.endDate).format("YYYY-MM-DD"),profile:r.profile[0]?r.profile[0].data.profile.id:null};(0,u.k)(("new"==o?(0,s.KR):(0,s.he))(r.id),n,function(e){c(!1),l?t(W(a,l)):(t(W(a,!1)),t(W(a,!0))),t(function(e){e({type:m}),e(f({activeFilter:"genrealFilter",activeFilterKey:"All"}))}),i()},function(e){return console.log(e)},u.Y.PUT,(0,d.XW)())}}var pe="[TODO APP] GET FOLDERS";var fe="[TODO APP] GET LABELS"},56086:function(e,t,n){"use strict";n.r(t);var r=n(51265),N=n.n(r),a=n(79545),o=n(56156),i=n.n(o),r=n(61432),S=n.n(r),L=n(35923),I=n(49073),a=(n(65129),n(6274)),o=n(12303),Y=n(99904),x=n(84403),R=n(95272),w=n(92466),M=n(48258),_=n(80896),k=n(41533),G=n(82186),Z=n(96282),J=n(19462),j=n(13786),F=n(65087),r=n(78279),W=n.n(r),U=n(78709),V=n(58913),X=n(90),$=n(92505),z=n(55110),K=n(78278),q=n(11208),H=n(88572),B=n(3089),Q=n(35965),ee=n(7074);function l(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function te(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach(function(e){i()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var ne={id:"",title:"",notes:"",startDate:new Date,dueDate:new Date,completed:!1,starred:!1,important:!1,deleted:!1,labels:[]},n="0 3px 1px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.13),0 0 0 1px rgba(0,0,0,0.02)",re=[{value:0},{value:10},{value:20},{value:30},{value:40},{value:50},{value:60},{value:70},{value:80},{value:90},{value:100}],ae=(0,a.Z)({root:{color:"#3880ff",height:2,padding:"15px 0"},thumb:{height:28,width:28,backgroundColor:"#fff",boxShadow:n,marginTop:-14,marginLeft:-14,"&:focus, &:hover, &$active":{boxShadow:"0 3px 1px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.3),0 0 0 1px rgba(0,0,0,0.02)","@media (hover: none)":{boxShadow:n}}},active:{},valueLabel:{left:"calc(-50% + 12px)",top:-22,"& *":{background:"transparent",color:"#000"}},track:{height:2},rail:{height:2,opacity:.5,backgroundColor:"#bfbfbf"},mark:{backgroundColor:"#bfbfbf",height:8,width:1,marginTop:-3},markActive:{opacity:1,backgroundColor:"currentColor"}})(o.Z);t.default=function(e){var t=(0,V.I0)(),n=(0,V.v9)(function(e){return e.todoApp.todos.todoDialog}),r=((0,V.v9)(function(e){return e.todoApp.labels}),(0,V.v9)(function(e){return e.contactsApp.contacts.approvedCompanies})),a=(0,U.useState)(null),o=S()(a,2),i=(p=(o[0],o[1],(0,L.cI)(te({},ne)))).form,l=p.handleChange,c=p.setForm,u=p.resetForm,a=(W()(i.startDate).format(W().HTML5_FMT.DATETIME_LOCAL_SECONDS),W()(i.dueDate).format(W().HTML5_FMT.DATETIME_LOCAL_SECONDS),(0,U.useState)([])),s=(o=S()(a,2))[0],d=o[1],p=(0,U.useState)([]),o=(a=S()(p,2))[0],f=a[1],p=(0,U.useState)([]),m=(a=S()(p,2))[0],O=a[1],p=(0,U.useState)(0),D=(a=S()(p,2))[0],P=a[1],p=(0,U.useState)(!1),p=(a=S()(p,2))[0],E=a[1],T=(0,z.UO)(),a=(0,U.useState)({startDate:new Date,endDate:void 0}),v=(a=S()(a,2))[0],g=a[1],y=(0,U.useCallback)(function(){var e;console.log({assigned_company:n.data}),"edit"===n.type&&n.data&&c(te({},n.data)),"activity"===n.type&&null!==(e=n.data)&&void 0!==e&&e.assigned_company&&(u(),O([]),C(),g({startDate:new Date(n.data.date_start),endDate:new Date(n.data.date_end)})),"new"===n.type&&(d([]),g({startDate:new Date,endDate:void 0}),c(te(te(te({},ne),n.data),{},{id:I.Z.generateGUID()})))},[n.data,n.type,c]);function h(){return E(!1),"activity"===n.type?t(ee.Bl()):"edit"===n.type?t(ee.a7()):t(ee.Ln())}function b(){return 0<i.title.length&&v.startDate&&v.endDate}(0,U.useEffect)(function(){if(n.props.open)return y(),function(){u()}},[n.props.open]);var C=function(e){var t;console.log(T.id,n.data.assigned_company.id,e),(0,H.k)((0,q.GL)(n.data.project.id,null===(t=n.data.assigned_company)||void 0===t?void 0:t.id,e),{},function(e){f(e),O(e.filter(function(e){return"Owner"==e.role||"Delegate"==e.role}).map(function(e){return{data:e,value:A(e),label:U.createElement("span",{className:"flex items-center pl-12"},A(e))}}))},function(e){return console.log(e)},H.Y.GET,(0,B.XW)())},A=function(e){return"".concat(e.profile.first_name," ").concat(e.profile.last_name)};return U.createElement(Y.Z,N()({},n.props,{onClose:h,fullWidth:!0,maxWidth:"sm",className:"custom-modal-new"}),U.createElement(x.Z,{position:"static",elevation:1},U.createElement(R.Z,{className:"flex"},U.createElement(w.Z,{variant:"h6",color:"inherit"},"new"===n.type?"New Todo":"activity"===n.type?"New Activity":"Edit Todo"),U.createElement("div",{className:"absolute right-m-12"},U.createElement(M.Z,{onClick:h,edge:"start",color:"inherit","aria-label":"close"},U.createElement(Q.Z,null))))),U.createElement(_.Z,{classes:{root:"p-0"}},U.createElement("div",{className:"px-20 sm:mb-24 mt-16 sm:mt-20 sm:px-32"},U.createElement(k.Z,{className:"mt-8 mb-24",required:!0,fullWidth:!0},U.createElement(G.Z,{label:"Task Title",autoFocus:!0,name:"title",value:i.title,onChange:l,required:!0,variant:"outlined"})),"activity"===n.type?U.createElement("div",{className:"mt-8 mb-16 select-dropdown"},U.createElement($.default,{placeholder:"Select Profile",variant:"fixed",isMulti:!0,textFieldProps:{label:"Profile",InputLabelProps:{shrink:!0},variant:"outlined"},onChange:function(e){O(e)},value:m,options:o.map(function(e){return{data:e,value:A(e),label:U.createElement("span",{className:"flex items-center"},A(e))}})})):r&&s&&!!r.length&&U.createElement("div",{className:"mt-8 mb-16 select-dropdown"},U.createElement($.default,{className:"",placeholder:"Select Company",variant:"fixed",isMulti:!0,textFieldProps:{label:"Company",InputLabelProps:{shrink:!0},variant:"outlined"},onChange:function(e){d(e.splice(e.length-1))},value:s,options:r.map(function(e){var t,n,r,a,o;return{data:e,value:null==e||null===(t=e.profile)||void 0===t||null===(n=t.company)||void 0===n?void 0:n.name,label:U.createElement("span",{className:"flex items-center"},U.createElement(Z.Z,{className:"list-item-icon mr-4",style:{color:null==e||null===(r=e.profile)||void 0===r||null===(a=r.company)||void 0===a?void 0:a.color_project},color:"action"},"label")," ",null==e||null===(o=e.profile)||void 0===o?void 0:o.company.name)}})})),U.createElement(k.Z,{className:"mt-8 mb-16",required:!0,fullWidth:!0},U.createElement(G.Z,{label:"Notes",name:"notes",multiline:!0,rows:"6",value:i.notes,onChange:l,variant:"outlined"})),U.createElement("div",{className:"flex -mx-4"},U.createElement("div",{className:"mt-8 mb-16 mx-4 relative static-form-label flex-1"},U.createElement(K.e,{label:"Start Date",inputVariant:"outlined",format:"DD/MM/yyyy",value:v.startDate,onChange:function(e){g(te(te({},v),{},{startDate:e}))},className:"mt-8 mb-16 w-full"})),U.createElement("div",{className:"mt-8 mb-16 mx-4 relative static-form-label flex-1"},U.createElement(K.e,{label:"End Date",inputVariant:"outlined",format:"DD/MM/yyyy",value:v.endDate,minDate:v.startDate,onChange:function(e){g(te(te({},v),{},{endDate:e}))},className:"mt-8 mb-16 w-full"}))),U.createElement("div",{className:"w-full zoom-125"},U.createElement("label",null,U.createElement("small",null,"Task Progress")),U.createElement("div",{className:"mx-8 mt-32 custom-ios-slider"},U.createElement(ae,{"aria-label":"ios slider",defaultValue:0,marks:re,onChange:function(e,t){return P(t)},valueLabelDisplay:"on"}))))),"new"===n.type||"activity"===n.type?U.createElement(J.Z,{className:"p-16 pb-24 px-44"},U.createElement(j.Z,{variant:"contained",color:"primary",size:"large",onClick:function(){var e;E(!0),t(X.rk(te(te({},i),{},{id:null===(e=n.data)||void 0===e?void 0:e.id,company:s,profile:m,progress:D},v),n.data.project.id,n.type,h,null===(e=n.data)||void 0===e?void 0:e.isGantt))},disabled:!b()},"Add ",p&&U.createElement(F.Z,{size:15,color:"secondary"}))):U.createElement(J.Z,{className:"justify-between p-8"},U.createElement("div",{className:"px-16"},U.createElement(j.Z,{variant:"contained",color:"primary",size:"large",onClick:function(){t(ee.CU(i)),h()},disabled:!b()},"Save")),U.createElement(M.Z,{className:"min-w-auto"},U.createElement(Z.Z,null,"delete"))))}}}]);