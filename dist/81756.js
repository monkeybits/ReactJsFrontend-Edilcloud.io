(self.webpackChunkfuse_react_app=self.webpackChunkfuse_react_app||[]).push([[81756],{81756:function(e,t,n){"use strict";n.r(t);var o=n(56156),r=n.n(o),a=n(79545),N=n.n(a),o=n(61432),C=n.n(o),a=n(32986),O=n(65129),i=n(68403),P=n(96569),j=n(5344),S=n(92466),A=n(86926),D=n(556),L=n(41713),F=n(25710),I=n(88325),R=n(13786),T=n(96282),o=n(40962),Y=n(28344),U=n(78709),X=n(58913),W=n(43812),z=n(7074),B=n(20074),H=n(88572),M=n(11208),$=n(3089),q=n(55110),G=n(10930),J=(n(26592),n(96133),n(53369));function c(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function K(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach(function(e){r()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var Q=(0,a.ZP)(function(){return n.e(89138).then(n.bind(n,89138))}),V=(0,a.ZP)(function(){return n.e(51204).then(n.bind(n,51204))});O.Z.enhance=function(e,t){return O.Z.map(e,function(e){return O.Z.extend({},e,t)})};var ee=(0,o.Z)(function(e){return{root:{zoom:"110%"},todoItem:{"&.completed":{background:"rgba(0,0,0,0.03)","& .todo-title, & .todo-notes":{textDecoration:"line-through"}}},nested:{paddingLeft:e.spacing(4)},paper:{marginRight:e.spacing(2)},anchor:{backgroundColor:i.Z[500],width:10,height:10,borderRadius:"50%",position:"absolute"}}});t.default=function(a){var i=(0,X.I0)(),t=(0,X.v9)(function(e){return e.todoApp.labels}),e=U.useState(!1),n=((h=C()(e,2))[0],h[1],U.useState("to-do"!=a.todo.status)),o=(_=C()(n,2))[0],r=_[1],c=(0,U.useState)([]),s=((Z=C()(c,2))[0],Z[1],(0,q.UO)(),ee(a)),l=(0,U.useState)(null),e=((y=C()(l,2))[0],y[1],(0,U.useState)([])),u=(h=C()(e,2))[0],d=h[1],n=(0,U.useState)([]),m=(_=C()(n,2))[0],f=_[1],c=(0,U.useState)(!1),p=((Z=C()(c,2))[0],Z[1]),l=(0,U.useState)([]),v=(y=C()(l,2))[0],g=y[1],e=U.useRef(),h=(0,U.useState)(!1),_=(n=C()(h,2))[0],k=n[1],c=(0,U.useState)(!1),l=(Z=C()(c,2))[0],b=Z[1],y=(0,X.v9)(function(e){e=e.chatApp;return null==e?void 0:e.company}),h=(0,J.$)("dashboard").t,E=(0,$.Fc)(),n=function(){var e;return null==E||null===(e=E.extra)||void 0===e?void 0:e.profile.role};function x(e,t){var n=[],t=t?u:v;Array.isArray(e)&&(n=[].concat(N()(e),N()(t)).filter(function(e){return e.is_exists})),console.log({ids:n}),n={id:a.todo.id,title:a.todo.title,description:a.todo.description,datetime_start:a.todo.datetime_start,datetime_end:a.todo.datetime_end,workers:null!==n&&void 0!==n&&n.length?n.map(function(e){return e.profile.id}):null},(0,H.k)((0,M.E1)(a.todo.id),n,function(e){},function(e){console.log(e)},H.Y.PUT,(0,$.XW)())}(0,U.useEffect)(function(){var e;null!==(e=a.todo)&&void 0!==e&&e.status&&"completed"==a.todo.status?r(!0):r(!1)},[null===(c=a.todo)||void 0===c?void 0:c.status]),(0,U.useEffect)(function(){var e;Array.isArray(a.todo.workers_in_activity)&&(e=O.Z.enhance(a.todo.workers_in_activity,{is_exists:!0}),d(e))},[a.todo.workers_in_activity]),(0,U.useEffect)(function(){var e;Array.isArray(a.todo.can_assign_in_activity)&&(e=O.Z.enhance(a.todo.can_assign_in_activity,{is_exists:!1}),g(e))},[a.todo.can_assign_in_activity]);var Z=function(e){w(e),k(!1),u.length||a.getDetailOfTask()},w=function(e){e.preventDefault&&e.stopPropagation&&(e.preventDefault(),e.stopPropagation())};return U.createElement(U.Fragment,null,U.createElement(P.Z,{className:(0,Y.Z)(s.todoItem,{completed:o},"border-solid border-b-1 mt-10 bordergrey bg-white px-0 custom-activity sm:px-8 touch-ripple-effect-remove"),checked:o,style:{borderLeft:"0px solid",borderLeftColor:null===(c=a.task.assigned_company)||void 0===c?void 0:c.color_project},onClick:function(e){e.preventDefault(),i(z.X_()),i(z.F8({todo:a.todo,task:a.task})),a.setTodoId(a.task.id)},dense:!0,button:!0},U.createElement("div",{className:"flex-col relative overflow-hidden"},U.createElement("div",null,U.createElement("div",{className:"flex items-center"},U.createElement(j.Z,{disabled:(null===(c=a.task.assigned_company)||void 0===c?void 0:c.id)!=y.id||"w"==n(),tabIndex:-1,disableRipple:!0,checked:o,onChange:function(e){var t;e.stopPropagation(),t=e.target.checked,e={title:a.todo.title,description:a.todo.description,datetime_start:a.todo.datetime_start,datetime_end:a.todo.datetime_end,workers:null!==(e=a.todo.workers)&&void 0!==e&&e.length?a.todo.workers.map(function(e){return e.id}):void 0,status:t?"completed":"to-do"},(0,H.k)((0,M.E1)(a.todo.id),e,function(e){},function(e){r(!t),console.log(e)},H.Y.PUT,(0,$.XW)()),r(t)},onClick:function(e){return e.stopPropagation()}}),U.createElement(S.Z,{variant:"subtitle1",className:"todo-title",color:o?"textSecondary":"inherit"},a.todo.title),U.createElement("div",{className:"ml-auto"}))),U.createElement("div",{className:"flex items-center"},(null===(o=a.task.assigned_company)||void 0===o?void 0:o.id)==y.id&&("d"==n()||"o"==n())&&U.createElement(G.ZP,{className:"custom-tippy",placement:"bottom",animation:"fade",arrow:!0,theme:"light-border",trigger:"click",onMount:function(){return b("true")},onHide:function(){return b("false")},onClickOutside:Z,content:U.createElement(A.Z,{className:s.paper},U.createElement(U.Fragment,null,!(null==u||!u.length)&&U.createElement(D.Z,{className:"px-8 pt-10 m-0 flex cusotm-checkbox-label",control:U.createElement(j.Z,{checked:u.every(function(e){return e.is_exists})&&v.every(function(e){return e.is_exists}),onClick:function(e){e.stopPropagation(),e.preventDefault(),p(e.target.checked);e=(e=N()(u)).map(function(e){return K(K({},e),{},{is_exists:!0})});d(e),x(e)},name:"checkedB"}),label:h("SELECT_ALL")}),null!=u&&u.length||null!=v&&v.length?U.createElement(U.Fragment,null,u.map(function(e,n){return U.createElement(L.Z,{onClick:w,className:"px-8",key:e.id},U.createElement(j.Z,{onClick:w,name:e.first_name,checked:!!e.is_exists,onChange:function(e){var t=N()(u);t[n]=K(K({},t[n]),{},{is_exists:e.target.checked}),[].concat(N()(t),N()(v)).some(function(e){return e.is_exists})?(d(t),x(t,!1)):W.Am.error("Can not remove everyone from activity")}}),U.createElement(F.Z,{className:"w-32 h-32",src:e.profile.photo}),U.createElement(I.Z,{className:"mx-8"},e.profile.first_name," ",e.profile.last_name))}),v.map(function(e,n){return U.createElement(L.Z,{onClick:w,className:"px-8",key:e.id},U.createElement(j.Z,{onClick:function(e){return e.stopPropagation()},name:e.first_name,checked:!!e.is_exists,onChange:function(e){var t=N()(v);t[n]=K(K({},t[n]),{},{is_exists:e.target.checked}),[].concat(N()(t),N()(u)).some(function(e){return e.is_exists})?(g(t),x(t,!0)):W.Am.error("Can not remove everyone from activity")}}),U.createElement(F.Z,{className:"w-32 h-32",src:e.profile.photo}),U.createElement(I.Z,{className:"mx-8"},e.profile.first_name," ",e.profile.last_name))})):U.createElement(U.Fragment,null,U.createElement(S.Z,{variant:"subtitle1",className:"todo-title p-8"},m.length?"You have no workers in your project, add from below list":"You have no workers in your company"),m.map(function(e,t){return e.is_exists?null:U.createElement(L.Z,{onClick:w,className:"px-8",key:e.id},U.createElement(F.Z,{className:"w-32 h-32",src:e.profile.photo}),U.createElement(I.Z,{className:"mx-8"},e.first_name," ",e.last_name),U.createElement(R.Z,{onClick:function(e){return function(e,t){var n,o;e.preventDefault();var r=N()(m),e=r[t];r[t]=K(K({},e),{},{is_exists:!0}),f(r),i(B.YR(a.task.project.id,{profile:e.id,role:null===(e=e.role)||void 0===e||null===(n=e.split(""))||void 0===n||null===(o=n[0])||void 0===o?void 0:o.toLocaleLowerCase()},!1))}(e,t)}},"Add"))}))))},U.createElement("div",{ref:e,className:"custom-member-menu flex items-center",onClick:_?Z:function(e){e.stopPropagation(),e.preventDefault(),w(e),k(!0)},"aria-haspopup":"true","aria-expanded":l},U.createElement(T.Z,{className:"bg-custom-primary text-white"},"person_add"))),U.createElement(Q,{workers:[].concat(N()(u.filter(function(e){return e.is_exists})),N()(v.filter(function(e){return e.is_exists})))})),U.createElement("div",{className:(0,Y.Z)(s.labels,"flex -mx-2")},null===(s=a.todo.labels)||void 0===s?void 0:s.map(function(e){return U.createElement(V,{className:"mx-2 mt-4",title:O.Z.find(t,{id:e}).title,color:O.Z.find(t,{id:e}).color,key:e})})))))}}}]);