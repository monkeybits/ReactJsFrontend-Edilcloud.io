(self.webpackChunkfuse_react_app=self.webpackChunkfuse_react_app||[]).push([[38596],{35923:function(e,t,n){"use strict";n.d(t,{Nr:function(){return a},KW:function(){return p},cI:function(){return r},KS:function(){return l},rf:function(){return c}});var t=n(56156),u=n.n(t),t=n(61432),o=n.n(t),s=n(65129),m=n(78709);function f(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}var r=function(e,t){var n=(0,m.useState)(e),r=(i=o()(n,2))[0],a=i[1],l=(0,m.useCallback)(function(t){t.persist(),a(function(e){return s.Z.setIn(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach(function(e){u()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},e),t.target.name,"checkbox"===t.target.type?t.target.checked:t.target.value)})},[]),c=(0,m.useCallback)(function(){s.Z.isEqual(e,r)||a(e)},[r,e]),n=(0,m.useCallback)(function(t,n){a(function(e){return s.Z.setIn(e,t,n)})},[]),i=(0,m.useCallback)(function(e){e&&e.preventDefault(),t&&t()},[t]);return{form:r,handleChange:l,handleSubmit:i,resetForm:c,setForm:a,setInForm:n}};var a=function(e,t,n){return(0,m.useRef)(s.Z.debounce(e,t,n)).current};var l=function(t,n){var r=(0,m.useRef)(t);(0,m.useEffect)(function(){r.current=t},[t]),(0,m.useEffect)(function(){var e;return n&&t&&"function"==typeof t&&(e=setTimeout(r.current,n||0)),function(){e&&clearTimeout(e)}},[t,n])};var c=function(e,t){var n=(0,m.useRef)(!0);(0,m.useEffect)(n.current?function(){n.current=!1}:e,t)},t=(n(45559),n(89962)),i=n.n(t);function d(e){var t=m.useRef();return i()(e,t.current)||(t.current=e),t.current}var p=function(e,t){m.useEffect(e,d(t))}},38596:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var r=n(68357),Z=n.n(r),a=n(61432),x=n.n(a),l=n(28129),y=n.n(l),O=n(78709),C=n(35923),c=n(40962),N=n(94678),k=n(1737),_=n(86926),P=n(92466),w=n(4248),I=n(15201),F=n(97272),S=n(4510),j=n(13786),R=n(58913),i=n(55110),T=n(3089),A=n(11208),D=n(28344),U=n(42401),L=n(95860),q=n(53369),z=n(10846),t=n(32986),o=n(96282),s=(0,t.ZP)(function(){return Promise.all([n.e(21284),n.e(87997)]).then(n.bind(n,87997))});function M(e){var n=e.setFile,t=e.file,r=e.remove,a=e.nameSpace,l=(0,q.$)(void 0===a?"edit_mainProfile":a).t,c=(0,O.useState)(null),e=x()(c,2),a=e[0],i=e[1],c=(0,O.useState)(!1),e=x()(c,2),c=e[0],u=e[1];return c?O.createElement(s,{image:a,viewCroper:c,onCrop:function(e){var t=new FileReader;t.onloadend=function(){n({fileData:e,imagePreviewUrl:t.result})},t.readAsDataURL(e)},onHide:function(){return u(!1)}}):null!=t&&t.imagePreviewUrl?O.createElement(O.Fragment,null,O.createElement("div",{className:"flex justify-center"},O.createElement("img",{className:"profile-img",src:t.imagePreviewUrl,alt:"profile"})),O.createElement("div",{className:"text-center mt-10"},O.createElement(j.Z,{variant:"contained",onClick:r},l("REMOVE")))):O.createElement(O.Fragment,null,O.createElement("div",{className:"flex justify-center mt-16 mb-20"},O.createElement("img",{className:"profile-img",src:"/assets/images/avatars/profile-img.png",alt:"profile"})),O.createElement("div",{className:"flex justify-center mt-16 mb-20"},O.createElement("input",{id:"add_user",hidden:!0,type:"file",onChange:function(e){i(URL.createObjectURL(e.currentTarget.files[0])),u(!0)}}),O.createElement("label",{htmlFor:"add_user",className:"text-2xl cursor-pointer"},O.createElement(o.Z,{fontSize:"inherit",className:"align-middle"},"add_circle")," ",l("UPLOAD_PHOTO"))))}var r=n(51265),u=n.n(r),a=n(6274),m=n(64584),f=n(82186),d=n(5344),l=n(68403),p=n(19199),t=n(65058),r=n(42356),v=O.createElement(t.Z,{fontSize:"small"}),E=O.createElement(r.Z,{fontSize:"small"}),g=(0,c.Z)(function(e){return{root:{background:"#ffffff)",color:e.palette.primary.contrastText}}});(0,a.Z)({root:{color:l.Z[400],"&$checked":{color:l.Z[600]}},checked:{}})(function(e){return O.createElement(m.Z,u()({color:"default"},e))});var V=function(e){var t=e.form,n=e.handleChange,r=(e.resetForm,e.value),a=e.setValue,l=(g(),(0,q.$)("edit_mainProfile").t);return O.createElement("form",{name:"registerForm",noValidate:!0,className:"flex flex-col justify-center w-full"},O.createElement(f.Z,{className:"mb-8",label:l("FIRST_NAME"),autoFocus:!0,type:"text",name:"fname",value:t.fname,onChange:n,variant:"outlined",required:!0,fullWidth:!0}),O.createElement(f.Z,{className:"mb-8",label:l("LAST_NAME"),autoFocus:!0,type:"text",name:"lname",value:t.lname,onChange:n,variant:"outlined",required:!0,fullWidth:!0}),O.createElement(f.Z,{disabled:!0,className:"mb-8",label:l("EMAIL"),type:"email",name:"email",value:t.email,onChange:n,variant:"outlined",required:!0,fullWidth:!0}),O.createElement(p.ZP,{options:["English","Italian"],disableCloseOnSelect:!0,getOptionLabel:function(e){return e},renderOption:function(e,t){t=t.selected;return O.createElement(O.Fragment,null,O.createElement(d.Z,{icon:v,checkedIcon:E,style:{marginRight:8},checked:t}),e)},inputValue:r,renderInput:function(e){return O.createElement(f.Z,u()({},e,{variant:"outlined",label:l("LANGUAGE")}))},onInputChange:function(e,t){return a(t)}}))},W=(0,c.Z)(function(e){return{root:{width:"100%",background:"#ffffff)",color:e.palette.primary.contrastText},button:{marginTop:e.spacing(1),width:"190px"},actionsContainer:{marginBottom:e.spacing(2)},resetContainer:{padding:e.spacing(3)}}});var h=(0,i.EN)((0,R.$j)(function(e){return{user:e.auth.user.data}})(function(e){function n(){t(function(e){return e+1}),1==d&&b()}function r(){t(function(e){return e-1})}var l=e.user,c=e.history,a=(0,q.$)("edit_mainProfile").t,i=(e=(0,C.cI)({fname:l&&l.user.first_name,lname:l&&l.user.last_name,email:l&&l.email?l.email:""})).form,u=e.handleChange,o=e.resetForm,s=e.setForm,m=(0,R.I0)(),f=((0,R.v9)(function(e){return e.auth.user}),W()),e=O.useState(0),d=(e=x()(e,2))[0],t=e[1],p=["BASIC_INFORMATION","UPLOAD_PROFILE_PICTURE"],e=O.useState(""),v=(e=x()(e,2))[0],E=e[1],e=O.useState(null),g=(e=x()(e,2))[0],h=e[1];(0,O.useEffect)(function(){var e,t;s({fname:l&&l.user.first_name,lname:l&&l.user.last_name,email:l&&l.user.email?l.user.email:""}),E(l&&"en"==(null===(e=l.user)||void 0===e?void 0:e.language)?"English":"Italian"),h({imagePreviewUrl:null==l||null===(t=l.user)||void 0===t?void 0:t.photo})},[l]);var b=function(){var e=Z()(y().mark(function e(){var t,n,r,a;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new FormData,e.t0=i.fname,e.t1=i.lname,e.t2="English"==v?"en":"it",g&&g.fileData)return e.next=7,(0,T.y6)(g.fileData);e.next=10;break;case 7:e.t3=e.sent,e.next=11;break;case 10:e.t3=void 0;case 11:for(a in e.t4=e.t3,n={first_name:e.t0,last_name:e.t1,language:e.t2,photo:e.t4},r=localStorage.getItem("jwt_access_token"),n)n[a]&&t.append(a,n[a]);z.Z.put((0,A.tj)(l.user.id),t,{headers:{"Content-Type":"multipart/form-data",Authorization:"JWT ".concat(r)}}).then(function(e){var e=e.data;m(L.M(e)),console.log({data:e});e=null===(e=c.location.state)||void 0===e?void 0:e.nextPath;c.push(e||"/apps/todo/all")}).catch(function(e){console.log(e)});case 16:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return O.createElement("div",{className:(0,D.Z)(f.root,"flex flex-col flex-auto flex-shrink-0")},O.createElement("div",{className:"flex flex-col w-full px-0"},O.createElement(U.Z,{animation:"transition.expandIn"},O.createElement(N.Z,null,O.createElement(k.Z,{className:"flex flex-col"},O.createElement(_.Z,{square:!0,elevation:0,className:(0,D.Z)(f.resetContainer,"pb-10")},O.createElement(P.Z,null,a("EDIT_YOUR_PROFILE"))),O.createElement(w.Z,{className:"px-0",activeStep:d,orientation:"vertical"},p.map(function(e,t){return O.createElement(I.Z,{key:e},O.createElement(F.Z,null,a(e)),O.createElement(S.Z,null,O.createElement(P.Z,null,function(e,t){switch(e){case 0:return O.createElement(V,t);case 1:return O.createElement(M,t);default:return"Unknown step"}}(t,0==t?{form:i,handleChange:u,resetForm:o,value:v,setValue:E}:{setFile:h,file:g,remove:function(){return h(null)}})),O.createElement("div",{className:(0,D.Z)(f.actionsContainer,"text-center custom-btn-group mt-12")},O.createElement("div",null,O.createElement(j.Z,{variant:"contained",disabled:0===d,onClick:r,size:"large",className:(0,D.Z)(f.button,"mr-8")},a("BACK")),O.createElement(j.Z,{size:"large",variant:"contained",color:"primary",onClick:n,className:f.button},d===p.length-1?a("FINISH"):a("NEXT"))))))})),d===p.length&&O.createElement(_.Z,{square:!0,elevation:0,className:f.resetContainer},O.createElement(P.Z,null,"All steps completed - you're finished")))))))}))}}]);